<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Model Gallery</title>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <!-- Load the QRCode library -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
  <!-- Import Anime.js library -->
  <script type="module" src="./lib/anime.esm.js"></script>
  <!-- Import our animation scripts -->
  <script type="module" src="./js/anime-animations.js"></script>
  <!-- External CSS -->
  <link rel="stylesheet" href="css/styles.css">
  <!-- Animation-specific styles -->
  <style>
    /* Animation-related styles */
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    
    /* Initial state for animations - elements will be invisible until animated */
    h1,
    .model-card {
      opacity: 0;
    }
    
    /* Modal animation base styles */
    .modal {
      transition: none;
      transform-origin: center center;
    }
    
    /* Updated loading animation */
    .spinner {
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    /* Connection status animation */
    .status-connecting {
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 0.5; }
      50% { opacity: 1; }
      100% { opacity: 0.5; }
    }
    
    /* Button styles - remove transitions in favor of Anime.js */
    .download-btn,
    .modal-download-btn,
    .modal-deploy-btn,
    .qr-close,
    .modal-refresh-btn {
      transition: none;
    }
    
    /* QR container styles */
    .qr-container {
      transform-origin: center center;
    }
    
    /* Enhanced status message */
    #statusMessage {
      transition: none;
    }
  </style>
</head>
<body>
  <h1>Space</h1>
  <div class="gallery">
    <!-- Your original model -->
    <div class="model-card" data-model="./models/31_10_2024.glb" data-title="My Model" data-desc="Original 3D model">
      <div class="model-container">
        <model-viewer
          src="./models/31_10_2024.glb"
          alt="Original 3D model"
          auto-rotate
          camera-controls
          shadow-intensity="1">
        </model-viewer>
      </div>
      <div class="model-info">
        <h2>My Model</h2>
        <p>Original 3D model</p>
        <a href="./models/31_10_2024.glb" download class="download-btn">Download</a>
      </div>
    </div>
    
    <!-- Temple model -->
    <div class="model-card" data-model="./models/20230204temple-transformed.glb" data-title="Temple" data-desc="Example 3D model">
      <div class="model-container">
        <model-viewer
          src="./models/20230204temple-transformed.glb"
          alt="Temple"
          auto-rotate
          camera-controls
          shadow-intensity="1">
        </model-viewer>
      </div>
      <div class="model-info">
        <h2>Temple</h2>
        <p>Example 3D model</p>
        <a href="./models/20230204temple-transformed.glb" download class="download-btn">Download</a>
      </div>
    </div>
    
    <!-- Hibiscus model -->
    <div class="model-card" data-model="./models/hibiscus.glb" data-title="Hibiscus" data-desc="Example 3D model">
      <div class="model-container">
        <model-viewer
          src="./models/hibiscus.glb"
          alt="hibiscus"
          auto-rotate
          camera-controls
          shadow-intensity="1">
        </model-viewer>
      </div>
      <div class="model-info">
        <h2>Hibiscus</h2>
        <p>Example 3D model</p>
        <a href="./models/hibiscus.glb" download class="download-btn">Download</a>
      </div>
    </div>

    <!-- Idol model from external source -->
    <div class="model-card" data-model="https://cdn.glitch.me/fe683ccc-7c71-4551-94d5-171a2e238fcf/saraswati_flower.glb" data-title="Idol" data-desc="Saraswati 3D model">
      <div class="model-container">
        <model-viewer
          src="https://cdn.glitch.me/fe683ccc-7c71-4551-94d5-171a2e238fcf/saraswati_flower.glb"
          alt="Idol"
          auto-rotate
          camera-controls
          shadow-intensity="1">
        </model-viewer>
      </div>
      <div class="model-info">
        <h2>Idol</h2>
        <p>Saraswati 3D model</p>
        <a href="https://cdn.glitch.me/fe683ccc-7c71-4551-94d5-171a2e238fcf/saraswati_flower.glb" download class="download-btn">Download</a>
      </div>
    </div>

    <!-- Bicycle model -->
    <div class="model-card" data-model="./models/bycycle.glb" data-title="Bicycle" data-desc="3D bicycle model">
      <div class="model-container">
        <model-viewer
          src="./models/bycycle.glb"
          alt="Bicycle"
          auto-rotate
          camera-controls
          shadow-intensity="1">
        </model-viewer>
      </div>
      <div class="model-info">
        <h2>Bicycle</h2>
        <p>3D bicycle model</p>
        <a href="./models/bycycle.glb" download class="download-btn">Download</a>
      </div>
    </div>
  </div>

  <!-- Modal overlay for enlarged model view -->
  <div class="overlay" id="modelOverlay">
    <div class="modal">
      <button class="close-button" id="closeButton">Ã—</button>
      <model-viewer
        id="modalModelViewer"
        camera-controls
        shadow-intensity="1"
        ar
        ar-modes="webxr scene-viewer quick-look">
      </model-viewer>
      <div class="modal-button-container">
        <a id="modalDownloadBtn" href="#" download class="modal-download-btn">Download</a>
        <button id="modalDeployBtn" class="modal-deploy-btn">
          <span>Deploy to Mobile</span>
        </button>
        <div id="statusMessage"></div>
        <div class="connection-status" id="connectionStatus" style="display: none;">
          <div class="status-indicator"></div>
          <span class="status-text"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- QR Code overlay with enhanced functionality -->
  <div class="qr-overlay" id="qrOverlay">
    <div class="qr-container">
      <h3>Mobile View</h3>
      <p>Scan this QR code with your mobile device to view the model</p>
      <canvas id="qr-code" width="200" height="200"></canvas>
      <p id="qr-url" style="font-size: 12px; word-break: break-all;"></p>
      
      <!-- Mobile refresh button -->
      <button id="refreshMobileBtn" class="modal-refresh-btn">
        Refresh Mobile
      </button>
      
      <!-- AR mode selector -->
      <div class="ar-mode-selector">
        <input type="checkbox" id="arModeSelector" checked>
        <label for="arModeSelector">Default AR Mode to Scene Viewer</label>
      </div>
      
      <div style="margin-top: 15px; font-size: 12px; color: #666;">
        This uses a third-party <a href="https://github.com/nwtgck/piping-server" target="_blank" style="color: #4285F4;">piping server</a> to deploy to your mobile device. This server does not store data.
      </div>
      
      <button class="qr-close" id="qrCloseButton">Close</button>
    </div>
  </div>

  <!-- External JavaScript -->
  <script src="js/gallery.js"></script>
  <!-- Replace original QR deploy with enhanced animated version -->
  <script type="module" src="js/enhanced-qr-deploy.js"></script>
</body>
</html>
